# 12. 虚函数与多态

## Inheritance（继承），表示is-a

上次课的例子：

![image-20240619184137211](https://raw.githubusercontent.com/Eric-Ceray/cloudimg/main/img/image-20240619184137211.png)

内存角度来思考。

![image-20240619201635577](https://raw.githubusercontent.com/Eric-Ceray/cloudimg/main/img/image-20240619201635577.png)

```C++
```

## Inheritance（继承）with virtual func（虚函数）

在使用**继承**的时候，要搭配**虚函数**来使用才会达到最强而有力的效果。

虚函数的定义：在任何一个成员函数之前加上virtual关键字，就成为了一个虚函数。

在继承的关系里面：所有的东西都能被继承下来。

- 数据可以被继承下来，占用了内存的一部分。
- 函数也可以被继承下来，但是函数的继承不应该从内存的角度理解，**函数的继承继承的是调用权**。

子类可以调用父类的函数，但是子类是否可以重新定义函数呢？这是我们讨论的重点。从这个角度来看，父类的成员函数可以分为三种：

- non-virtual函数：你不希望derived class重新定义（override，覆写）它。
- virtual函数：你希望derived class重新定义（override，覆写）它，并且你对它已有默认定义。
- pure-virtual函数：你希望derived class==**一定**==要重新定义（override，覆写）它，你对它没有默认定义。

```C++
class Shape
{
public:
    virtual void draw() const = 0; //pure virtual
    virtual void error(const std::string& msg); //impure virtual
    int objectID() const; //non-virtual    
};

class Rectangle: public Shape {};
class Ellipse: public Shaoe {};
```

PS：其实纯虚函数也能有定义，但是本课程不细讲；

## Inheritance（继承）with virtual

经典例子：使用PPT，当要open一个file的时候，分为三步：

1. check file name
2. search file
3. open file

这几个步骤其实任何人来写内容和表现形式都差不多，于是先把可以写的东西先写好（即父类）。

但是父类中一些函数暂时没有办法写出来，要让子类去写它。这种就必须把他设计成virtual func

空函数和纯虚函数选择的权衡；

